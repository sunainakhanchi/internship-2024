create database org;
use org;
create table customers(
customerid int primary key,
name varchar(255),
email varchar(255),
joindate date
);
select * from customers;
create table products(productid int primary key,name varchar(255),category
varchar(255),price decimal(10,2));
insert into products(productid,name,category,price)values(1,"laptop","electronics",999.99),(2,"phone","electronics",499.99),(3,"lamp","home decor",28.99),(4,"airpods","electronics",399.99),(5,"smart tv","electronics",599.99),(6,"smart watch","electronics",565.99),(7,"wall clock","home decor",35.99),(8,"flower pot","home decor",48.99),(9,"doll","toys",6.99),(10,"car","toys",8.99);
select * from products;
create  table orders(orderid int primary key,customerid int,orderdate date,totalamount decimal(10,2),foreign key(customerid) references customers(customerid));
insert into orders(orderid,customerid,orderdate,totalamount)values(1,1,"2020-02-14",1499.00),(2,2,"2021-05-04",499.99),(3,3,"2021-03-03",399.99),(4,4,"2020-05-04",599.99),(5,5,"2021-02-03",299.99),(6,6,"2023-05-01",139.99),(7,7,"2019-03-04",666.99),(8,8,"2023-09-08",222.55),(9,9,"2015-07-06",344.67),(10,10,"2017-06-03",99.23);
create table orderdetails(orderdetailid int primary key,orderid int,productid int,quantity int,priceperunit decimal(10,2),foreign key(orderid)references orders(orderid),foreign key(productid) references products(productid));
insert into orderdetails(orderdetailid,orderid,productid,quantity,priceperunit)values(1,1,1,1,999.99),(2,3,1,1,25.99),(3,3,3,2,499.99),(4,4,4,8,888.99),(5,4,5,4,666.77),(6,5,6,8,999.99),(7,6,7,6,555.66),(8,7,8,7,888.99),(9,7,9,3,398.99),(10,10,7,8,999.99);
#list all customers
select name from customers;
#show all products in "electronics category"
select name from products where category="electronics";
#find the total number of orders placed
select sum(quantity) from orderdetails;
#display the details of most recent order
select * from orders order by orderdate desc limit 1;
#list  all products along with the names of the customers who ordered them
select c.name as customers,p.name as products from products p ,customers c;
#show orders that include more than one product
select name from products join orderdetails on products.productid=orderdetails.productid where quantity>1;
 #Find the total sales amount for each customer.
 select totalamount from orders join customers on customers.customerid=orders.customerid;

#calculate the total revenue generated by each product category
select category, sum(price) from products group by category ;
#detemine the average order values
select avg(totalamount) from orders;
#find the month with highest number of orders
select sum(totalamount),orderdate from orders group by orderdate;
#identify the customer who have not placed any order
select name from customers left join orders on orders.customerid=customers.customerid where orders.customerid=null;
#products that has never been ordered
select name from products left join orderdetails on orderdetails.productid=products.productid where quantity =null; 
#show top 3 best selling products;
select name from products join orderdetails on orderdetails.productid=products.productid order by quantity;
#list order placed in last month
select * from orders where orderdate>="2023-12-01" and orderdate<"2024-01-01";
#determine the oldest customer in terms of membership duration
select * from customers order by joindate limit 2;
#tom smith is the oldest member joined in 2005. we set the limit 2 beacuse there can be two customers who joined on same date by canging the limi no we can check if there are more records of same date 

#rank customers based on their total spending
select name from customers join orders on orders.customerid=customers.customerid order by totalamount;
#. Identify the most popular product category
select category from products join orderdetails on orderdetails.productid=products.productid order by quantity;
#. Calculate the month-over-month growth rate in sales.
#add new customer to the customers table
insert into customers values( 11,"tannu toe",null,"2020-11-05") ;
select * from customers;
#update the price of a specific product
update products set price=223.99  where productid=4;
